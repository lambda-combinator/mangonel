# Section 7: Physical — Running on Real Hardware

**Duration:** 1 week  
**Prerequisites:** Sections 1-6 (Complete system working in simulation)  
**Skills:** PCB design, soldering, hardware debugging

---

## 7.1 Overview

This section takes the simulated system to real hardware:

1. **USB-JTAG Interface** (C, ~200 lines) — Programming and debugging interface
2. **FPGA Board Design** — Custom PCB with FPGA and peripherals
3. **Board Bringup** — Testing and debugging the physical board

---

## 7.2 Project 1: USB-JTAG Interface

**Estimated Lines:** ~200 C (MCU firmware)

### 7.2.1 JTAG Overview

```
JTAG (IEEE 1149.1) BASICS
=========================

JTAG is a serial protocol for:
  - Boundary scan testing
  - Programming FPGAs
  - Debugging processors

Signals:
  TMS  - Test Mode Select (controls state machine)
  TCK  - Test Clock
  TDI  - Test Data In (to device)
  TDO  - Test Data Out (from device)
  TRST - Test Reset (optional)


JTAG STATE MACHINE (TAP Controller)
===================================

                           ┌──────────────────────────────────────────┐
                           │                                          │
          ┌────────────────▼────────────────┐                        │
          │         TEST-LOGIC-RESET        │◀──────────────────┐    │
          └────────────────┬────────────────┘                   │    │
                           │ TMS=0                              │    │
                           ▼                                    │    │
          ┌────────────────────────────────┐                    │    │
          │         RUN-TEST/IDLE          │◀──────┐           │    │
          └────────────────┬───────────────┘       │           │    │
                           │ TMS=1                 │           │    │
                           ▼                       │           │    │
          ┌────────────────────────────────┐       │           │    │
          │        SELECT-DR-SCAN          │───────┤ TMS=0     │TMS=1│
          └────────────────┬───────────────┘       │           │    │
                           │ TMS=1                 │           │    │
                           ▼                       │           │    │
          ┌────────────────────────────────┐       │           │    │
          │        SELECT-IR-SCAN          │───────┤           │    │
          └────────────────┬───────────────┘       │           │    │
                           │ TMS=0                 │           │    │
                                                   │           │    │
     DR Path:              │              IR Path: │           │    │
     ┌──────────┐          │          ┌──────────┐│           │    │
     │CAPTURE-DR│          │          │CAPTURE-IR││           │    │
     └────┬─────┘          │          └────┬─────┘│           │    │
          │ TMS=0          │               │ TMS=0│           │    │
          ▼                │               ▼      │           │    │
     ┌──────────┐          │          ┌──────────┐│           │    │
     │ SHIFT-DR │──┐       │          │ SHIFT-IR │──┐         │    │
     └────┬─────┘  │       │          └────┬─────┘  │         │    │
          │ TMS=1  │TMS=0  │               │ TMS=1  │TMS=0    │    │
          ▼        │       │               ▼        │         │    │
     ┌──────────┐  │       │          ┌──────────┐  │         │    │
     │ EXIT1-DR │◀─┘       │          │ EXIT1-IR │◀─┘         │    │
     └────┬─────┘          │          └────┬─────┘            │    │
          │ TMS=1          │               │ TMS=1            │    │
          ▼                │               ▼                  │    │
     ┌──────────┐          │          ┌──────────┐            │    │
     │UPDATE-DR │──────────┴──────────│UPDATE-IR │────────────┘    │
     └──────────┘                     └──────────┘                  │
          │                                │                        │
          └────────────────────────────────┴────────────────────────┘


JTAG INSTRUCTIONS (Typical FPGA)
================================

IDCODE    - Read device ID
BYPASS    - 1-bit bypass register
SAMPLE    - Sample I/O pins
EXTEST    - Drive I/O pins
PROGRAM   - Enter programming mode
CFG_IN    - Shift configuration data
USERCODE  - Read user-defined code
```

### 7.2.2 USB MCU Selection

```
USB MICROCONTROLLER OPTIONS
===========================

For USB to JTAG conversion, we need a small MCU:

Option 1: Cypress FX2LP (CY7C68013A)
  - USB 2.0 High Speed (480 Mbps)
  - 8051 core
  - Proven (used in many FPGA programmers)
  - Moderate complexity

Option 2: STM32F103 (Blue Pill)
  - USB 1.1 Full Speed (12 Mbps)
  - ARM Cortex-M3
  - Very cheap (~$2)
  - Easy to program

Option 3: RP2040 (Raspberry Pi Pico)
  - USB 1.1 Full Speed
  - Dual ARM Cortex-M0+
  - PIO for precise timing
  - $4, very available

Recommendation: RP2040 (Pico)
  - Cheap and available
  - PIO makes JTAG timing easy
  - Good community support
  - TinyUSB library


MCU PINOUT (RP2040)
===================

┌──────────────────────────────────────┐
│             RP2040 Pico              │
│                                      │
│  USB ◀──────────────────────────────│───── To Host PC
│                                      │
│  GPIO 0  ───────────────────────────│───── JTAG TCK
│  GPIO 1  ───────────────────────────│───── JTAG TMS
│  GPIO 2  ───────────────────────────│───── JTAG TDI
│  GPIO 3  ◀──────────────────────────│───── JTAG TDO
│  GPIO 4  ───────────────────────────│───── JTAG TRST (optional)
│                                      │
│  GPIO 5  ───────────────────────────│───── FPGA PROG_B
│  GPIO 6  ◀──────────────────────────│───── FPGA DONE
│  GPIO 7  ◀──────────────────────────│───── FPGA INIT_B
│                                      │
│  3.3V    ───────────────────────────│───── FPGA VCCIO
│  GND     ───────────────────────────│───── FPGA GND
│                                      │
└──────────────────────────────────────┘
```

### 7.2.3 Implementation Checklist

#### File: `hw/jtag_adapter/main.c` (RP2040 Firmware)

- [ ] **USB initialization**
  - TinyUSB library
  - CDC (serial) interface for commands
  - Or: Custom vendor interface

- [ ] **JTAG pin setup**
  - Configure GPIOs
  - TCK, TMS, TDI as output
  - TDO as input

- [ ] **jtag_clock()**
  - One TCK cycle
  - Set TCK low, delay, set high, delay
  - Configurable frequency

- [ ] **jtag_shift_bit()**
  - Set TMS value
  - Set TDI value
  - Clock TCK
  - Read TDO

- [ ] **jtag_shift_bits()**
  - Shift multiple bits
  - Handle TMS changes

- [ ] **jtag_goto_state()**
  - Navigate TAP state machine
  - Track current state

- [ ] **jtag_shift_ir()**
  - Go to SHIFT-IR state
  - Shift instruction
  - Go to RUN-TEST/IDLE

- [ ] **jtag_shift_dr()**
  - Go to SHIFT-DR state
  - Shift data
  - Go to RUN-TEST/IDLE

- [ ] **Command parser**
  - Parse commands from USB
  - Execute JTAG operations
  - Return results

- [ ] **Protocol (simple text or binary)**
  ```
  Commands:
    RESET           - Reset TAP
    IDCODE          - Read device ID
    PROGRAM <len>   - Start programming
    DATA <bytes>    - Send config data
    VERIFY          - Verify programming
    RUN             - Release FPGA to run
  ```

#### File: `hw/jtag_adapter/pio_jtag.pio` (PIO program)

- [ ] **JTAG PIO program**
  - Bit-banging with precise timing
  - Much faster than GPIO

- [ ] **clock_out program**
  - Generate TCK
  - Shift TDI
  - Sample TDO

#### File: `tools/fpga_prog/fpga_prog.py` (Host software)

- [ ] **USB communication**
  - Open serial port or USB device
  - Send commands
  - Receive responses

- [ ] **Bitstream loading**
  - Read bitstream file
  - Parse format (bin or bit)
  - Send to adapter

- [ ] **Programming sequence**
  - Reset FPGA
  - Enter programming mode
  - Send configuration data
  - Verify DONE signal
  - Release FPGA

- [ ] **Command line interface**
  - Specify bitstream file
  - Specify device
  - Verify option

---

## 7.3 Project 2: FPGA Board Design

### 7.3.1 Board Specifications

```
CENTURION BOARD SPECIFICATIONS
==============================

FPGA:
  - Xilinx Spartan-7 or Artix-7 (XC7S50 or XC7A35T)
  - Or: Lattice ECP5 (more open toolchain)
  - BGA package (requires reflow soldering)
  - Sufficient LUTs for CPU + peripherals
  - Sufficient BRAM for memory

Memory:
  - 1-4 MB SRAM (ISSI IS61WV102416)
  - Or: SDRAM if brave
  - 16 or 32-bit width

Clock:
  - 50 MHz oscillator
  - FPGA PLL for other frequencies

Power:
  - USB powered (5V input)
  - 3.3V for I/O and SRAM
  - 1.0V or 1.8V for FPGA core
  - LDO regulators

USB:
  - JTAG adapter (RP2040 or similar)
  - UART (FT232R or CH340)
  - Both can share USB port with hub

Serial:
  - USB-UART bridge
  - Header for external serial

Ethernet:
  - Ethernet PHY (LAN8720A or similar)
  - MII or RMII interface
  - RJ-45 jack with magnetics

SD Card:
  - Micro SD slot
  - SPI mode interface

User I/O:
  - 4-8 LEDs
  - 2-4 push buttons
  - Reset button

Expansion:
  - General purpose header (IDE cable compatible?)
  - I2C, SPI, GPIO

Power Indicator:
  - LED for power
  - LED for FPGA configured


OPTIONAL ADVANCED FEATURES
==========================

USB Host:
  - USB PHY (USB3300 or similar)
  - For keyboard/mouse input

Video Output:
  - NTSC composite (easy, resistor DAC)
  - Or: VGA (resistor DAC)

PS/2:
  - Keyboard/mouse connector
  - Simple serial protocol

Audio:
  - PWM output through filter
  - Or: I2S DAC
```

### 7.3.2 Block Diagram

```
BOARD BLOCK DIAGRAM
===================

                                        ┌─────────────────┐
                                        │   RJ-45 Jack    │
                                        │  (w/ magnetics) │
                                        └────────┬────────┘
                                                 │
     ┌─────────────────────────────────────────┐ │
     │                                         │ │
     │               FPGA                      │ │
     │        ┌───────────────────┐           │ │
     │        │                   │           │ │
     │        │    Centurion      │           │ │
     │        │      SOC          │           │ │
     │        │                   │           │ │
     │        │  - RISC-V Core    │           │ │
     │        │  - UART           │   MII     │ │   ┌──────────────┐
     │        │  - Ethernet MAC   │◀─────────────▶  │ Ethernet PHY │
     │        │  - SD Controller  │           │ │   │   LAN8720    │
     │        │  - MMU            │           │ │   └──────────────┘
     │        │                   │           │ │
     │        └─────────┬─────────┘           │ │
     │                  │                     │ │
     │      ┌───────────┼───────────┐        │ │
     │      │           │           │        │ │
     │      ▼           ▼           ▼        │ │
     │  ┌───────┐  ┌────────┐  ┌────────┐   │ │
     │  │ UART  │  │  SPI   │  │ Memory │   │ │
     │  │ Pins  │  │ (SD)   │  │  Bus   │   │ │
     │  └───┬───┘  └───┬────┘  └───┬────┘   │ │
     │      │          │           │        │ │
     └──────┼──────────┼───────────┼────────┘ │
            │          │           │          │
            ▼          ▼           ▼          │
       ┌────────┐  ┌────────┐  ┌────────┐    │
       │USB-UART│  │ SD Card│  │  SRAM  │    │
       │ FT232  │  │  Slot  │  │ 1-4 MB │    │
       └────────┘  └────────┘  └────────┘    │
            │                                 │
            │   ┌─────────────────────────┐   │
            │   │    Power Supply          │   │
            │   │                         │   │
            │   │  USB 5V                 │   │
            │   │    │                    │   │
            │   │    ├──▶ 3.3V LDO ──────│───┼──▶ I/O, SRAM, PHY
            │   │    │                    │   │
            │   │    └──▶ 1.0V LDO ──────│───┼──▶ FPGA Core
            │   │                         │   │
            │   └─────────────────────────┘   │
            │                                 │
            │   ┌─────────────────────────┐   │
            │   │    USB-JTAG (RP2040)    │   │
            │   │                         │   │
            └───│◀──── USB Hub ──────────│───┼──── USB to PC
                │                         │   │
                │      TCK,TMS,TDI,TDO ──│───┼──── JTAG to FPGA
                │                         │   │
                └─────────────────────────┘   │
                                              │
       ┌──────┐  ┌──────┐  ┌──────────────┐  │
       │ LEDs │  │ BTNs │  │ 50MHz Osc    │  │
       └──┬───┘  └──┬───┘  └──────┬───────┘  │
          │         │             │          │
          └─────────┴─────────────┴──────────┘
```

### 7.3.3 Schematic Checklist

#### Power Supply Section

- [ ] **USB input protection**
  - Polyfuse for overcurrent
  - ESD protection diodes

- [ ] **3.3V regulator**
  - LDO (AMS1117-3.3 or similar)
  - Input/output capacitors
  - Calculate current: FPGA I/O + SRAM + PHY + misc

- [ ] **1.0V/1.8V core regulator**
  - Check FPGA requirements
  - Low-noise LDO preferred
  - Adequate decoupling

- [ ] **Power sequencing**
  - Core power before I/O power
  - Or: use power-good signals

- [ ] **Decoupling capacitors**
  - 100nF per power pin
  - Bulk capacitors (10µF-100µF)
  - Place close to pins

#### FPGA Section

- [ ] **FPGA device selection**
  - Consider: LUTs, BRAM, I/O count, package
  - Recommend: XC7S50 or LFE5U-25F

- [ ] **Configuration**
  - JTAG connection to programmer
  - SPI flash for persistent config (optional)
  - Configuration mode pins

- [ ] **Clock input**
  - 50MHz oscillator
  - Proper termination

- [ ] **I/O banks**
  - Match voltage levels (3.3V)
  - Consider I/O standards

- [ ] **Decoupling**
  - Follow manufacturer guidelines
  - Multiple capacitor values

#### Memory Section

- [ ] **SRAM selection**
  - 16-bit or 32-bit width
  - Speed vs size tradeoff
  - Example: IS61WV102416BLL (1M × 16, 10ns)

- [ ] **Address/data connections**
  - All address lines to FPGA
  - All data lines to FPGA
  - Control: CE#, OE#, WE#, LB#, UB#

- [ ] **Timing considerations**
  - Setup/hold times
  - Access time vs clock frequency

#### Ethernet Section

- [ ] **PHY selection**
  - LAN8720A (MII/RMII, cheap)
  - Or: DP83848 (MII)

- [ ] **MII connections**
  - TX_CLK, TXD[3:0], TX_EN
  - RX_CLK, RXD[3:0], RX_DV, RX_ER
  - MDC, MDIO
  - nRST, nINT

- [ ] **Magnetics and RJ-45**
  - Integrated magnetics jack preferred
  - Or: separate transformer + jack

- [ ] **PHY power**
  - 3.3V supply
  - Proper decoupling

#### SD Card Section

- [ ] **SD card slot**
  - Micro SD push-push type
  - Card detect switch (optional)

- [ ] **SPI connections**
  - CLK, MOSI (DI), MISO (DO), CS#
  - 3.3V power

- [ ] **Level shifting (if needed)**
  - SD card is 3.3V native
  - Match FPGA I/O voltage

#### USB Section

- [ ] **USB connector**
  - Micro-B or USB-C
  - ESD protection

- [ ] **USB hub (optional)**
  - Share USB between JTAG and UART
  - Or: two USB ports

- [ ] **USB-UART bridge**
  - FT232RL or CH340G
  - TX, RX to FPGA UART

- [ ] **USB-JTAG MCU**
  - RP2040 or similar
  - JTAG pins to FPGA
  - FPGA config pins (PROG_B, DONE, INIT_B)

#### User Interface Section

- [ ] **LEDs**
  - 4-8 LEDs with current-limiting resistors
  - Different colors helpful

- [ ] **Buttons**
  - Reset button (directly to FPGA reset)
  - 2-3 user buttons
  - Debounce in FPGA (or RC filter)

#### Expansion Section

- [ ] **GPIO header**
  - 20-40 pin header
  - Ground pins interspersed
  - 3.3V power available

### 7.3.4 PCB Layout Checklist

- [ ] **Board size**
  - Credit card size or similar
  - 2 or 4 layer

- [ ] **Component placement**
  - FPGA central
  - Decoupling caps near power pins
  - Oscillator near FPGA clock input
  - USB connectors at edge

- [ ] **Power planes**
  - Solid ground plane
  - Power distribution

- [ ] **Signal integrity**
  - Keep high-speed traces short
  - Avoid stubs
  - Proper termination if needed

- [ ] **Impedance control**
  - 50Ω for single-ended signals (if high speed)
  - 100Ω differential for USB

- [ ] **BGA routing**
  - Via-in-pad (if needed)
  - Escape routing pattern
  - Consider using FPGA I/O near edge

---

## 7.4 Project 3: Board Assembly and Bringup

### 7.4.1 Assembly Equipment

```
REQUIRED TOOLS
==============

Reflow Soldering:
  - Toaster oven (modified) or hot plate
  - Thermocouple thermometer (critical!)
  - Solder paste (leaded recommended for first-timers)
  - Solder paste stencil (from PCB manufacturer)
  - Tweezers and pick-and-place by hand
  - Flux and solder wick for rework

Hand Soldering:
  - Soldering iron with fine tip
  - For through-hole and large SMD
  - Hot air station (helpful for rework)

Inspection:
  - Magnifying glass or microscope
  - Multimeter
  - Oscilloscope (very helpful)
  - Logic analyzer (helpful)

Supplies:
  - Isopropyl alcohol (cleaning)
  - PCB holder or vise
  - Anti-static mat and wrist strap


REFLOW SOLDERING PROFILE
========================

Temperature profile for leaded solder (Sn63/Pb37):

Temperature (°C)
    │
250 ┤                      ┌─────┐
    │                     │     │  Peak: 215-225°C
    │                    │       │  for 10-30 sec
200 ┤                   │         │
    │               ┌──┘           └──┐
    │              │  Soak: 150-200°C │
150 ┤            │    for 60-120 sec  │
    │          │                        │
    │        │                           │
100 ┤      │    Preheat: ~2°C/sec         │
    │    │                                  │
    │  │                                      │
 50 ┤│                                          │  Cool: ~3°C/sec
    ││                                           │
────┴┴───────────────────────────────────────────┴───── Time
    0     1     2     3     4     5     6     7  (minutes)

Tips:
- Use thermocouple ON the board (not air temp)
- Practice with a scrap board first
- Peak temp is most critical
- Don't exceed 260°C (damages components)
```

### 7.4.2 Assembly Checklist

- [ ] **PCB inspection**
  - Check for manufacturing defects
  - Verify dimensions match design
  - Check via connections with multimeter

- [ ] **Apply solder paste**
  - Use stencil for consistency
  - Thin, even layer
  - Inspect with magnification

- [ ] **Place components (order)**
  1. FPGA (BGA - most critical)
  2. Small passives (capacitors, resistors)
  3. ICs (SRAM, PHY, USB bridges)
  4. Connectors (SD, USB, RJ45)
  5. Through-hole last (after reflow)

- [ ] **Reflow**
  - Follow temperature profile
  - Monitor with thermocouple
  - Watch for solder flow

- [ ] **Inspection**
  - Check all solder joints
  - Look for bridges (especially BGA)
  - Check component orientation

- [ ] **Hand solder through-hole**
  - Headers
  - Large connectors

- [ ] **Clean**
  - Remove flux residue
  - Isopropyl alcohol and brush

### 7.4.3 Bringup Checklist

#### Step 1: Power Supply

- [ ] **Visual inspection**
  - No shorts
  - No solder bridges

- [ ] **Check power rails before powering**
  - Measure resistance between power and ground
  - Should not be zero!

- [ ] **Apply power**
  - Use current-limited supply initially
  - Check all voltage rails
  - Verify within spec

- [ ] **Check current consumption**
  - Should be reasonable (tens of mA without FPGA config)
  - High current = short

#### Step 2: JTAG Programming

- [ ] **Verify JTAG connections**
  - Continuity to FPGA pins
  - No shorts between signals

- [ ] **Connect JTAG adapter**
  - Verify voltage levels match

- [ ] **Read FPGA ID**
  - Should return valid ID code
  - Proves JTAG working

- [ ] **Program simple bitstream**
  - LED blinker is traditional first test
  - Verify LEDs blink

- [ ] **Verify configuration**
  - DONE pin should go high
  - Current consumption increases

#### Step 3: Basic I/O

- [ ] **Test LEDs**
  - All LEDs can light
  - Correct polarity

- [ ] **Test buttons**
  - Read button states
  - Debouncing works

- [ ] **Test UART**
  - Connect serial terminal
  - Send characters, verify echo
  - Verify both directions

#### Step 4: Memory

- [ ] **Basic SRAM test**
  - Write patterns to all addresses
  - Read back and verify
  - Test data patterns: 0x00, 0xFF, 0x55, 0xAA

- [ ] **Memory timing test**
  - Verify at target clock frequency
  - Check for bit errors

- [ ] **Stress test**
  - Random reads/writes
  - Extended duration

#### Step 5: SD Card

- [ ] **Card detection**
  - Insert card, verify detected
  - Remove card, verify not detected

- [ ] **SPI communication**
  - Send CMD0 (reset)
  - Should get response

- [ ] **Initialize card**
  - Full initialization sequence
  - Read CID/CSD registers

- [ ] **Read test**
  - Read known sector
  - Verify data correct

- [ ] **Write test**
  - Write test data
  - Read back and verify

#### Step 6: Ethernet

- [ ] **PHY reset**
  - Toggle reset line
  - Verify PHY initializes

- [ ] **PHY register access**
  - Read PHY ID via MDIO
  - Should match datasheet

- [ ] **Link detection**
  - Connect to switch/router
  - Verify link LED lights
  - Read link status register

- [ ] **Packet transmission**
  - Send test frame
  - Capture with Wireshark on PC
  - Verify correct format

- [ ] **Packet reception**
  - Send packet from PC
  - Verify received correctly

- [ ] **Ping test**
  - Run full network stack
  - Ping from PC to board
  - Verify responses

#### Step 7: Full System

- [ ] **Boot system**
  - Load full bitstream
  - Verify kernel boots

- [ ] **Run tests**
  - Memory tests
  - Filesystem tests
  - Network tests

- [ ] **User programs**
  - Shell working
  - cat, ls, etc.

- [ ] **Network services**
  - telnetd accessible
  - Browse webpage from external machine

---

## 7.5 Troubleshooting Guide

### 7.5.1 Common Problems

```
TROUBLESHOOTING TREE
====================

Board doesn't power on:
├── Check USB connection
├── Check for shorts (especially on power rails)
├── Verify regulator output
└── Check component orientation (especially LDOs)

JTAG not working:
├── Verify JTAG connections (TCK, TMS, TDI, TDO)
├── Check JTAG voltage levels
├── Verify FPGA is powered
├── Check for BGA solder issues
└── Try slower JTAG clock

FPGA doesn't configure:
├── Verify bitstream is correct device
├── Check configuration pins
├── Verify DONE pin
├── Check INIT_B pin (indicates config error)
└── Verify power sequencing

SRAM not working:
├── Check address/data connections
├── Verify control signals (CE, OE, WE)
├── Check timing (clock too fast?)
├── Verify power to SRAM
└── Check for solder bridges

Ethernet not working:
├── Check PHY power and reset
├── Verify crystal/oscillator
├── Check MII connections
├── Verify magnetics orientation
├── Check transformer center tap
└── Verify PHY strapping pins

SD card not working:
├── Check card insertion
├── Verify SPI connections
├── Check power to slot
├── Verify clock speed (start slow)
└── Check card compatibility (older cards work better)
```

### 7.5.2 Debug Techniques

- [ ] **Use oscilloscope**
  - Check clock frequencies
  - Verify signal integrity
  - Debug timing issues

- [ ] **Use logic analyzer**
  - Capture bus transactions
  - Debug protocols (SPI, UART, MII)
  - Verify state machines

- [ ] **Use FPGA debug**
  - Embed logic analyzer (ILA)
  - Bring internal signals to test points

- [ ] **Divide and conquer**
  - Test subsystems independently
  - Simple test bitstreams

- [ ] **Compare to simulation**
  - Same test in simulation vs hardware
  - Find discrepancies

---

## 7.6 Production Files Checklist

### 7.6.1 Files to Generate

- [ ] **Gerber files**
  - Copper layers
  - Solder mask
  - Silkscreen
  - Drill files

- [ ] **Bill of Materials (BOM)**
  - All components
  - Part numbers
  - Quantities
  - Suppliers

- [ ] **Pick and place file**
  - Component positions
  - Rotations
  - For automated assembly

- [ ] **Schematic PDF**
  - For reference
  - Include revision number

- [ ] **Assembly drawing**
  - Component placement diagram
  - Polarity marks

- [ ] **Stencil file**
  - For solder paste application

### 7.6.2 PCB Manufacturer Specifications

```
TYPICAL PCB SPECIFICATIONS
==========================

Layers: 2 or 4
Thickness: 1.6mm
Copper weight: 1oz
Surface finish: HASL or ENIG
Solder mask: Green (or your choice)
Silkscreen: White
Min trace/space: 6/6 mil (0.15mm)
Min drill: 0.3mm
Via size: 0.4mm drill, 0.8mm pad

Recommended manufacturers:
- JLCPCB (cheap, fast)
- PCBWay
- OSH Park (quality, US-based)
- Eurocircuits (Europe)
```

---

## 7.7 Concepts to Internalize

After completing this section:

1. **JTAG protocol**: Standard debug interface for ICs
2. **Reflow soldering**: Temperature profile is critical
3. **Power sequencing**: Core before I/O
4. **Signal integrity**: High-speed signals need care
5. **Methodical bringup**: Test one thing at a time
6. **Debug mindset**: Divide, conquer, verify

---

## 7.8 Celebration

If you've made it this far, you've built:

- ✓ A RISC-V processor from logic gates
- ✓ An assembler to program it
- ✓ A C compiler to write software
- ✓ A linker to combine programs
- ✓ A Unix-like operating system
- ✓ Network stack with TCP/IP
- ✓ A text-based web browser
- ✓ Real hardware to run it all

**Congratulations! You understand computers at a fundamental level that few people ever achieve.**

---

## 7.9 What's Next?

Ideas for extension:

- **Performance**: Pipelining improvements, caches, branch prediction
- **Features**: Floating point, compressed instructions
- **OS**: More syscalls, multiple users, permissions
- **Network**: DHCP, DNS, HTTPS (ambitious!)
- **Graphics**: VGA output, framebuffer, simple UI
- **Input**: USB keyboard/mouse, PS/2
- **Sound**: PWM audio, music player
- **Languages**: Write a Forth, Lisp, or other language
- **Games**: Text adventure, simple graphics games

The foundation you've built can support any of these!

---

## Appendix: Complete Course Timeline

| Week | Section | Topics |
|------|---------|--------|
| 0.5 | Intro | Environment setup, FPGA basics, Verilator/cocotb |
| 0.5 | Bringup | LED blinker, UART, SystemVerilog fundamentals |
| 1 | Processor | Assembler (Python) |
| 2 | Processor | RISC-V CPU core (SystemVerilog) |
| 3 | Processor | CPU debugging, bootrom, integration |
| 4 | Compiler | C compiler frontend (Haskell) |
| 5 | Compiler | C compiler codegen, linker (Python) |
| 6 | Compiler | libc, ethernet, bootloader |
| 7 | OS | MMU design and implementation |
| 8 | OS | Kernel core: processes, memory |
| 9 | OS | Filesystems, user programs |
| 10 | Browser | TCP/IP stack, telnetd |
| 11 | Browser | Dynamic linking, web browser |
| 12 | Physical | PCB design, assembly, bringup |

**Total: ~12 weeks for dedicated study, longer for part-time**
